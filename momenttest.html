<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>

</head>
<body>

<script src="js/jquery-1.10.2.js"></script>
<script src="js/moment-with-langs.min.js"></script>
<script>
$(function(){

  moment.lang('ja', {
      weekdays: ["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],
      weekdaysShort: ["日","月","火","水","木","金","土"],
  });

  var m = moment("2013-01-26T21:00");
  console.log("日時： "+ m.format("M月DD日"));
  console.log("時間： "+ m.format("HH:mm") + " 〜 " + m.add("minutes",90).format("HH:mm"));

  function searchTime(datetime, endcount) {

    var mo = moment(datetime).add("minutes", 6);

    var results = [];

    var interval = 150;
    for(var i = 0; i < endcount; i++ ){
      var m = mo.clone().add("minutes", ((i * interval)));
      console.log(m);
      results[i] = {};

      results[i].start = {
        year: m.year(),
        month: m.month(),
        date: m.date(),
        hour: m.hour(),
        minutes: m.minutes()
      };

      m.add("minutes", interval);
      results[i].end = {
        year: m.year(),
        month: m.month(),
        date: m.date(),
        hour: m.hour(),
        minutes: m.minutes()
      };


    }

    var resultsJson = JSON.stringify(results);
    return resultsJson;
  }

  function convertMoment(resultTimes){

    var results = [];

    var times = JSON.parse(resultTimes);
    $.each(times, function(idx) {
      var start = this.start;
      var end = this.end;

      var startMoment = moment({
        year: start.year,
        month: start.month,
        day: start.date,
        hour: start.hour,
        minutes: start.minutes
      });
      var endMoment = moment({
        year: end.year,
        month: end.month,
        day: end.date,
        hour: end.hour,
        minutes: end.minutes
      });

      // console.log(startMoment.format("M月DD日"));
      // console.log(startMoment.format("HH:mm") + " 〜 " + endMoment.format("HH:mm"));
      results[idx] = {
        date: startMoment.format("M月DD日"),
        startTime: startMoment.format("HH:mm"),
        endTime: endMoment.format("HH:mm")
      };
    });

    return results;
  }

  function displayScheduleMoment(schedule){
    $.each(schedule, function() {
      console.log("日付："+ this.date);
      console.log("出発："+ this.startTime);
      console.log("到着："+ this.endTime);
    });
  }


  var times = searchTime("2013-01-26T15:30", 3);
  var schedule = convertMoment(times);

  displayScheduleMoment(schedule);

});

</script>
</body>
</html>